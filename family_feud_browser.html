<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Family Feud – Laptop Edition</title>
<style>
body {
    margin: 0;
    padding: 0;
    background: #020d26;
    color: white;
    font-family: "Arial Black", sans-serif;
}
h1 {
    font-size: 4vw;
    color: #ffd700;
    text-align: center;
    margin: 10px 0;
    text-shadow: 2px 2px #000;
}
.board {
    max-width: 1200px;
    margin: auto;
    padding: 20px;
}
#question {
    font-size: 2.5vw;
    margin: 20px 0;
}
.answers {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
}
.answer {
    display: flex;
    justify-content: space-between;
    padding: 15px;
    background: #ffcc00;
    color: #020d26;
    font-weight: bold;
    border-radius: 10px;
    font-size: 2vw;
    cursor: pointer;
    perspective: 1000px;
}
.answer .front, .answer .back {
    width: 100%;
    display: flex;
    justify-content: space-between;
    backface-visibility: hidden;
    transition: transform 0.8s;
    padding: 0 10px;
}
.answer .back { transform: rotateY(180deg); }
.answer.revealed .front { transform: rotateY(180deg); }
.answer.revealed .back { transform: rotateY(0deg); }

input {
    font-size: 2vw;
    padding: 8px;
    width: 60%;
    margin: 10px 0;
}
button {
    font-size: 1.8vw;
    padding: 8px 16px;
    margin: 5px;
    border-radius: 8px;
    font-weight: bold;
    border: none;
    cursor: pointer;
    background: #ffd700;
    color: #020d26;
}
.strike {
    font-size: 5vw;
    color: red;
    display: inline-block;
    margin: 0 10px;
    transition: transform 0.3s;
}
.team-score {
    font-size: 2.5vw;
    margin: 10px 0;
}
.current-team {
    font-size: 2vw;
    font-weight: bold;
    margin: 10px 0;
}
.final-result {
    font-size: 3vw;
    color: #00ff00;
    margin-top: 20px;
    text-align: center;
}

@keyframes pulseWin {
  0% { transform: scale(1); color: #00ff00; text-shadow: 1px 1px #000; }
  50% { transform: scale(1.2); color: #fff; text-shadow: 3px 3px #00ff00; }
  100% { transform: scale(1); color: #00ff00; text-shadow: 1px 1px #000; }
}
.win-pulse { animation: pulseWin 1s infinite; }

@keyframes winBgFlash {
  0% { background-color: #020d26; }
  50% { background-color: #004400; }
  100% { background-color: #020d26; }
}
.win-background { animation: winBgFlash 1s infinite; }
</style>
</head>
<body>

<h1>FAMILY FEUD</h1>

<div class="board">
    <div class="team-score" id="teamScores">Team A: 0 | Team B: 0</div>
    <h2 id="question"></h2>
    <div class="answers" id="answers"></div>

    <div>Strikes</div>
    <div>Team A: <span id="strikesA"></span></div>
    <div>Team B: <span id="strikesB"></span></div>

    <div class="current-team" id="currentTeam"></div>

    <div>Time Left for Current Guess: <span id="roundTimer">30</span>s</div>

    <input id="guessInput" placeholder="Enter answer">
    <br>
    <button id="submitBtn" onclick="submitAnswer()">Submit</button>
    <button id="pauseBtn" onclick="togglePause()">Pause</button>

    <div class="controls">
        <button id="switchBtn" onclick="switchTeam()">Switch Team</button>
        <button id="nextBtn" onclick="nextQuestion()">Next Question</button>
        <button id="revealBtn" onclick="revealAll()">Reveal All</button>
    </div>

    <div class="final-result" id="finalResult"></div>
</div>

<!-- SOUND EFFECTS -->
<audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-4.mp3"></audio>
<audio id="wrongSound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>
<audio id="revealSound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3"></audio>
<audio id="teamSwitchSound" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>

<script>
const gameData = [
{
    question: "Who is the Tarsier in the Family?",
    answers: [
        { text: "Tita Ella", points: 20, revealed: false },
        { text: "Ate Anne", points: 12, revealed: false },
        { text: "Dr Joy", points: 8, revealed: false },
        { text: "Mommy Nene", points: 6, revealed: false },
        { text: "Judge Grace", points: 5, revealed: false },
        { text: "Ninang Glo", points: 4, revealed: false },
        { text: "Bastik", points: 2, revealed: false },
        { text: "All Girls", points: 1, revealed: false }
    ]
},
{
    question: "Who is the Quietest member?",
    answers: [
        { text: "Tito Adows", points: 15, revealed: false },
        { text: "Tito Basil", points: 12, revealed: false },
        { text: "None", points: 8, revealed: false },
        { text: "Tito Mon", points: 6, revealed: false },
        { text: "Vincent", points: 4, revealed: false },
        { text: "Nina", points: 3, revealed: false },
        { text: "Moana", points: 2, revealed: false }
    ]
},
{
    question: "Name a phrase or expression that Daddy Pepe is famous for saying.",
    answers: [
        { text: "whatever", points: 20, revealed: false },
        { text: "my pabs", points: 16, revealed: false },
        { text: "ha ha", points: 12, revealed: false },
        { text: "consistent lang", points: 7, revealed: false },
        { text: "isa pa pang delete", points: 5, revealed: false },
        { text: "love daddy pepe", points: 5, revealed: false },
        { text: "no problem", points: 3, revealed: false }
    ]
},
{
    question: "Name one Famous Song which is special to the Victoria Family",
    answers: [
        { text: "l-o-v-e", points: 20, revealed: false },
        { text: "angelina", points: 18, revealed: false },
        { text: "my girl", points: 14, revealed: false },
        { text: "i want it that way", points: 10, revealed: false },
        { text: "an affair to remember", points: 8, revealed: false },
        { text: "tanging yaman", points: 6, revealed: false },
        { text: "sound of music", points: 4, revealed: false }
    ]
},
{
    question: "Who is the official photographer of the family?",
    answers: [
        { text: "Tita Ella", points: 17, revealed: false },
        { text: "Tito Ben", points: 12, revealed: false },
        { text: "Tita Bong", points: 10, revealed: false },
        { text: "Dr Joy", points: 8, revealed: false },
        { text: "Tito Jess", points: 6, revealed: false },
        { text: "Justin", points: 4, revealed: false }
    ]
},
{
    question: "Who is the family tech support - the person everyone goes to when their phone or wifi is not working?",
    answers: [
        { text: "Tito Jess", points: 12, revealed: false },
        { text: "Justin", points: 10, revealed: false },
        { text: "Jewel", points: 8, revealed: false }
    ]
}
];

let currentQuestionIndex = 0;
let currentTeam = "A";
let strikes = {A:0, B:0};
let teamPoints = {A:0, B:0};
const maxStrikes = 3;
let roundTime = 30; 
let timerInterval;
let timerPaused = false;

const correctSound = document.getElementById("correctSound");
const wrongSound = document.getElementById("wrongSound");
const revealSound = document.getElementById("revealSound");
const teamSwitchSound = document.getElementById("teamSwitchSound");

function loadQuestion() {
    const q = gameData[currentQuestionIndex];
    q.answers.forEach(a=>a.revealed=false);
    strikes={A:0,B:0};
    document.getElementById("finalResult").innerText="";
    document.body.classList.remove("win-background");
    renderBoard();
    resetTimer();
}

function renderBoard() {
    const q = gameData[currentQuestionIndex];
    document.getElementById("question").innerText = q.question;

    const answersDiv = document.getElementById("answers");
    answersDiv.innerHTML="";
    q.answers.forEach((a,i)=>{
        const div=document.createElement("div");
        div.className="answer "+(a.revealed?"revealed":"");
        div.innerHTML=`<div class="front"><span>${i+1}. __________</span><span>${a.points}</span></div>
                       <div class="back"><span>${i+1}. ${a.text.toUpperCase()}</span><span>${a.points}</span></div>`;
        answersDiv.appendChild(div);
    });

    ["A","B"].forEach(t=>{
        document.getElementById("strikes"+t).innerHTML="❌ ".repeat(strikes[t]);
    });

    document.getElementById("currentTeam").innerText=`Current Team: Team ${currentTeam}`;
    document.getElementById("teamScores").innerText=`Team A: ${teamPoints.A} | Team B: ${teamPoints.B}`;
}

document.getElementById("guessInput").addEventListener("keydown", function(e){
    if(e.key==="Enter") submitAnswer();
});

/* ========== RELAXED MATCHING ========== */
function normalize(str){
    return str.toLowerCase().replace(/[^a-z0-9 ]/g,"").trim();
}

function levenshtein(a,b){
    const matrix = Array.from({length:b.length+1},(_,i)=>[i]);
    for(let j=0;j<=a.length;j++) matrix[0][j]=j;
    for(let i=1;i<=b.length;i++){
        for(let j=1;j<=a.length;j++){
            matrix[i][j]=Math.min(
                matrix[i-1][j]+1,
                matrix[i][j-1]+1,
                matrix[i-1][j-1]+(a[j-1]===b[i-1]?0:1)
            );
        }
    }
    return matrix[b.length][a.length];
}

function similarity(a,b){
    const dist = levenshtein(a,b);
    return 1 - dist / Math.max(a.length,b.length);
}

function isRelaxedMatch(answer, guess){
    const a = normalize(answer);
    const g = normalize(guess);
    if(a.includes(g)) return true;  // partial match
    if(similarity(a,g) >= 0.6) return true; // fuzzy match
    return false;
}

function submitAnswer(){
    resetTimer(); 
    const input=document.getElementById("guessInput");
    const guess=input.value.trim();
    input.value="";
    if(!guess) return;

    const q=gameData[currentQuestionIndex];
    const match=q.answers.find(a=>!a.revealed && isRelaxedMatch(a.text, guess));

    if(match){
        match.revealed=true;
        teamPoints[currentTeam]+=match.points;
        correctSound.play(); renderBoard();
    }else{
        strikes[currentTeam]++;
        wrongSound.play();
        const el=document.getElementById("strikes"+currentTeam);
        el.style.transform="scale(1.5)";
        setTimeout(()=>el.style.transform="scale(1)",300);
        if(strikes[currentTeam]>=maxStrikes){ switchTeam();}
        renderBoard();
    }
}

function switchTeam(){
    currentTeam=currentTeam==="A"?"B":"A";
    teamSwitchSound.play(); renderBoard(); resetTimer();
}

function nextQuestion(){
    currentQuestionIndex++;
    if(currentQuestionIndex>=gameData.length){
        clearInterval(timerInterval);
        let winner="";
        if(teamPoints.A>teamPoints.B) winner="Team A Wins!";
        else if(teamPoints.B>teamPoints.A) winner="Team B Wins!";
        else winner="It's a Tie!";
        const finalEl=document.getElementById("finalResult");
        finalEl.innerText=`GAME OVER\n${winner}\nFinal Scores - Team A: ${teamPoints.A} | Team B: ${teamPoints.B}`;
        finalEl.classList.add("win-pulse");
        document.body.classList.add("win-background");
        document.getElementById("guessInput").disabled=true;
        document.querySelectorAll("button").forEach(b=>b.disabled=true);
        document.getElementById("currentTeam").innerText="GAME OVER";
        return;
    }
    loadQuestion(); 
}

function revealAll(){
    const q=gameData[currentQuestionIndex];
    q.answers.forEach(a=>a.revealed=true);
    revealSound.play(); renderBoard();
}

function startTimer(){
    document.getElementById("roundTimer").innerText = roundTime;
    clearInterval(timerInterval);
    timerPaused = false;
    timerInterval = setInterval(()=>{
        if(!timerPaused){
            roundTime--;
            document.getElementById("roundTimer").innerText = roundTime;
            if(roundTime <= 0){
                clearInterval(timerInterval);
                alert(`Time's up for Team ${currentTeam}! Counting as a wrong attempt.`);
                strikes[currentTeam]++;
                renderBoard();
                if(strikes[currentTeam]>=maxStrikes){ switchTeam(); }
                resetTimer(); 
            }
        }
    },1000);
}

function resetTimer(){
    roundTime = 30; 
    startTimer();
}

function togglePause(){
    timerPaused = !timerPaused;
    document.getElementById("pauseBtn").innerText = timerPaused ? "Resume" : "Pause";
}

loadQuestion();
</script>

</body>
</html>
